(function($){'use strict';$.fn.twittie=function(){var options=(arguments[0]instanceof Object)?arguments[0]:{},callback=(typeof arguments[0]==='function')?arguments[0]:arguments[1];var settings=$.extend({'username':null,'list':null,'count':4,'hideReplies':false,'dateFormat':'%b/%d/%Y','template':'{{date}} - {{tweet}}','apiPath':'api/tweet.php'},options);if(settings.list&&!settings.username){$.error('If you want to fetch tweets from a list, you must define the username of the list owner.');}
var linking=function(tweet){var twit=tweet.replace(/(https?:\/\/([-\w\.]+)+(:\d+)?(\/([\w\/_\.]*(\?\S+)?)?)?)/ig,'<a href="$1" target="_blank" title="Visit this link">$1</a>').replace(/#([a-zA-Z0-9_]+)/g,'<a href="http://twitter.com/search?q=%23$1&amp;src=hash" target="_blank" title="Search for #$1">#$1</a>').replace(/@([a-zA-Z0-9_]+)/g,'<a href="http://twitter.com/$1" target="_blank" title="$1 on Twitter">@$1</a>');return twit;};var dating=function relative_time(time_value){var values=time_value.split(" ");time_value=values[1]+" "+values[2]+", "+values[5]+" "+values[3];var parsed_date=Date.parse(time_value);var relative_to=(arguments.length>1)?arguments[1]:new Date();var delta=parseInt((relative_to.getTime()-parsed_date)/1000);delta=delta+(relative_to.getTimezoneOffset()*60);if(delta<60){return'less than a minute ago';}else if(delta<120){return'about a minute ago';}else if(delta<(60*60)){return(parseInt(delta/60)).toString()+' minutes ago';}else if(delta<(120*60)){return'about an hour ago';}else if(delta<(24*60*60)){return'about '+(parseInt(delta/3600)).toString()+' hours ago';}else if(delta<(48*60*60)){return'1 day ago';}else{return(parseInt(delta/86400)).toString()+' days ago';}};var templating=function(data){var temp=settings.template;var temp_variables=['date','tweet','avatar','url','retweeted','screen_name'];for(var i=0,len=temp_variables.length;i<len;i++){temp=temp.replace(new RegExp('{{'+temp_variables[i]+'}}','gi'),data[temp_variables[i]]);}
return temp;};this.html('<span class="tweets_loader">Loading...</span>');var that=this;$.getJSON(settings.apiPath,{username:settings.username,list:settings.list,count:settings.count,exclude_replies:settings.hideReplies},function(twt){that.find('span').fadeOut('fast',function(){for(var i=0;i<settings.count;i++){if(twt[i]){var temp_data={date:dating(twt[i].created_at),tweet:(twt[i].retweeted)?linking('RT @'+twt[i].user.screen_name+': '+twt[i].retweeted_status.text):linking(twt[i].text),avatar:'<img src="'+twt[i].user.profile_image_url+'" />',url:'http://twitter.com/'+twt[i].user.screen_name+'/status/'+twt[i].id_str,retweeted:twt[i].retweeted,screen_name:linking('@'+twt[i].user.screen_name),};that.append('<div class="tweet">'+templating(temp_data)+'</div>');}else{break;}}
$(".tweets_feed").find(".tweets_loader").remove();if(typeof callback==='function'){callback();}});});};})(jQuery);